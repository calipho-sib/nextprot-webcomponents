<link rel="import" href="../polymer/polymer.html">
<!--
`overview-section`
Top page section present on every viewer
@demo demo/index.html 
-->
<dom-module id="overview-section">
  <template>
    <style>
      :host {
        display: block;
      }
      dd{
        margin-left:15px;
      }
      .subsection-title {
        color: grey;
      }
      .paragraph {
        margin:10px 10px;
      }
      #extender {
        float:right;
        margin-top:-5px;
      }
    </style>
    <div id="proteinTitle">
      <button id="extender" class="btn btn-default">Extend overview</button>
      <h3>
        <template is="dom-if" if="{{data.geneName}}">
          <template is="dom-if" if="{{data.geneName.0.name}}">
            {{data.geneName.[0].name}}  â†’
          </template>
        </template>
        {{data.entryName}} <!--this should be inline-->
        <template is="dom-repeat" items="{{data.recommendedProteinName}}" as="rpn">
          <template is="dom-if" if="{{rpn.EC}}">[<template is="dom-repeat" items="{{rpn.EC}}" as="ec"> <a target='_blank' href="{{nxUrl}}/term/{{ec}}">{{ec}}</a> <span hidden$="[[!_checkIfLast(rpn.EC,index)]]">,</span> </template> ] </template>
          <template is="dom-if" if="{{rpn.mainShortName}}">( {{rpn.mainShortName}} ) </template>
        </template>
      </h3>
    </div>
    <div id="INFOS-LESS" style="display:block;margin-top:15px;">
      <template is="dom-if" if="{{data.recommendedProteinName.mainSynonymName}}">
        <div id="synonym-less" class="row">
          <div class="col-md-3 col-xs-3" style="color: grey;text-align:right">Protein also known as :</div>
          <div class="col-md-9 col-xs-9">{{#recommendedProteinName}}{{#mainSynonymName}}{{name}}{{#if synonym}} ({{synonym}}) {{/if}}{{/mainSynonymName}} {{#if others}} ; {{/if}}{{#others}}{{type}}{{plural names}}:{{#names}} {{name}}{{#unless @last}},{{/unless}}{{/names}}{{#unless @last}}; {{/unless}}{{/others}}{{/recommendedProteinName}}</div>
        </div>
      </template>
      <template is="dom-if" if="{{!data.recommendedProteinName.mainSynonymName&&data.recommendedProteinName.others}}">
      <div id="synonym-other-less" class="row">
        <div class="col-md-3 col-xs-3" style="color: grey;text-align:right">Protein also known as :</div>
        <div class="col-md-9 col-xs-9">{{#recommendedProteinName}}{{#others}} {{type}}{{plural names}}:{{#names}}{{name}}{{#unless @last}},{{/unless}}{{/names}}{{#unless @last}}; {{/unless}}{{/others}}{{/recommendedProteinName}}</div>
      </div>
      </template>

      <template is="dom-if" if="{{data.cleavage}}">
      <div id="cleavage-less" class="row">
        <div class="col-md-3 col-xs-3" style="color: grey;text-align:right">Cleaved into :</div>
        <div class="col-md-6 col-xs-6">{{#cleavage}}{{#names}}<span>{{name}}{{#unless @last}}; {{/unless}}</span>{{/names}}{{/cleavage}}</div>
      </div>
      </template>
      <div id="gene-less" class="row">
        <template is="dom-if" if="{{data.geneName}}">
          <template is="dom-if" if="{{data.geneName.0.name}}">
            <div class="col-md-3 col-xs-3" style="color: grey;text-align:right">Gene name :</div>
            <div class="col-md-6 col-xs-6" >
              <template is="dom-repeat" items="{{data.geneName}}" as="gn">{{gn.name}}<span hidden$="[[!_checkIfLast(geneName,index)]]">; </span></template></div>
          </template>
          <template is="dom-if" if="{{!data.geneName.0.name}}">
            <div class="col-md-3 col-xs-3" style="color: grey;text-align:right">ORF name :</div>
            <div class="col-md-6 col-xs-6">{{data.geneName.0.orf.0.name}}</div>
          </template>
        </template>
        <template is="dom-if" if="{{!data.geneName}}">
          <div class="col-md-3 col-xs-3" style="color: grey;text-align:right">Gene name :</div>
          <div class="col-md-6 col-xs-6" >None assigned yet</div>
        </template>
      </div>
      {{#if families}}
      <div id="family-less" class="row">
        <div class="col-md-3 col-xs-3 subsection-title" style="color: grey;text-align:right">Family name :</div>
        <div class="col-md-6 col-xs-6">{{#families}}<span>{{#superfamily}}{{{link_to "term"}}}{{/superfamily}}{{#if family}}{{#if superfamily}} >> {{/if}}{{#family}} {{{link_to "term"}}} {{/family}}{{/if}}{{#if subfamily}}{{#if family}} >> {{/if}}{{#subfamily}}{{{link_to "term"}}} {{/subfamily}}{{/if}}</span>{{/families}}</div>
      </div>
      {{/if}}
    </div>
    <div id="INFOS-FULL" style="display:none">
      <div id="protein-full" class="row">
        <div class="col-md-1 col-xs-2 text-uppercase subsection-title">Protein</div>
        <div class="col-md-9 col-xs-8">
          <dl>
            <dt>Recommended name</dt>
            {{#recommendedProteinName}}
            <dd>{{name}} {{#if EC}}[{{#EC}} {{{link_to "EC"}}} {{#unless @last}},{{/unless}} {{/EC}} ] {{/if}}{{#synonyms}} {{#if short}}<span><span style="color:grey">Short: </span> {{#short}}{{this}}{{#unless @last}} , {{/unless}}{{/short}}</span>{{/if}}{{/synonyms}}</dd>
            {{/recommendedProteinName}}
            {{#if alternativeProteinNames}}
            {{#alternativeProteinNames}}
            <dt>{{type}}{{plural names}}</dt>
            {{#names}}
            <dd> {{name}}
              {{#synonyms}}{{#if EC}}[{{#EC}} {{{link_to "EC"}}} {{#unless @last}},{{/unless}} {{/EC}} ] {{/if}} {{#if short}}<span><span style="color:grey">Short: </span> {{#short}}{{this}}{{#unless @last}} , {{/unless}}{{/short}}</span>{{/if}}{{/synonyms}}
            </dd>
            {{/names}}
            {{/alternativeProteinNames}}
            {{/if}}
            {{#if functionalRegionNames}}
            {{#functionalRegionNames}}
            <dt>Include the following {{names.length}} functional region{{plural names}}</dt>
            {{#names}}
            <dd> {{name}}
              {{#synonyms}}{{#if EC}}[{{#EC}} {{{link_to "EC"}}} {{#unless @last}},{{/unless}} {{/EC}} ] {{/if}} {{#if full}}<span><span style="color:grey">Alternative name{{plural full}}:</span> {{#full}}{{this}}{{#unless @last}} ; {{/unless}}{{/full}}</span>{{/if}}{{/synonyms}}
            </dd>
            {{/names}}
            {{/functionalRegionNames}}
            {{/if}}
            {{#if cleavage}}
            {{#cleavage}}
            <dt>Cleaved into the following {{names.length}} chain{{plural names}}</dt>
            {{#names}}
            <dd>{{name}} {{#synonyms}}{{#if EC}}[{{#EC}} {{{link_to "EC"}}} {{#unless @last}},{{/unless}} {{/EC}} ] {{/if}} {{#if full}}<span><span style="color:grey">Alternative name{{plural full}}:</span> {{#full}}{{this}}{{#unless @last}} ; {{/unless}}{{/full}}</span>{{/if}}{{/synonyms}}</dd>
            {{/names}}
            {{/cleavage}}
            {{/if}}
            {{#if isoforms}}
            <dt>Spliced into the following {{isoforms.length}} isoform{{plural isoforms}}</dt>
            {{#isoforms}}
            <dd>{{name}} {{#if synonyms}}<span style="color:grey"> Alternative name{{plural synonyms}}: </span>{{#synonyms}}{{name}}{{#unless @last}} ; {{/unless}}{{/synonyms}}{{/if}}</dd>
            {{/isoforms}}
            {{/if}}
          </dl>
        </div>
      </div>
      <div id="gene-full" class="row">
        <div class="col-md-1 col-xs-2 text-uppercase subsection-title">Gene</div>
        <div class="col-md-9 col-xs-8">
          <dl>
            {{#if geneName}}
            {{#geneName}}
            {{#if name}}
            <dt>Recommended name</dt>
            <dd>{{name}}</dd>
            {{/if}}
            {{#if synonyms}}
            <dt>Alternative name{{plural synonyms}}</dt>
            {{#synonyms}}
            <dd> {{name}}</dd>
            {{/synonyms}}
            {{/if}}
            {{#if orf}}
            <dt>ORF name{{plural orf}}</dt>
            {{#orf}}
            <dd> {{name}}</dd>
            {{/orf}}
            {{/if}}
            {{#unless @last}}
            <br>
            {{/unless}}
            {{/geneName}}
            {{else}}
            <dt>Recommended name</dt>
            <dd>None assigned yet</dd>
            {{/if}}
          </dl>
        </div>
      </div>
      {{#if families}}
      <div id="family-full" class="row">
        <div class="col-md-1 col-xs-2 text-uppercase subsection-title">Family</div>
        <div class="col-md-9 col-xs-8">
          <dl>
            {{#families}}
            {{#if superfamily}}
            {{#superfamily}}
            <dt>Superfamily</dt>
            <dd>{{{link_to "term"}}}</dd>
            {{/superfamily}}
            {{/if}}
            {{#if family}}
            {{#family}}
            <dt>Family</dt>
            <dd>{{{link_to "term"}}}</dd>
            {{/family}}
            {{/if}}
            {{#if subfamily}}
            {{#subfamily}}
            <dt>Subfamily</dt>
            <dd>{{{link_to "term"}}}</dd>
            {{/subfamily}}
            {{/if}}
            {{/families}}
          </dl>
        </div>
      </div>
      {{/if}}
      <div id="History-full" class="row">
        <div class="col-md-1 col-xs-2 text-uppercase subsection-title">History</div>
        <div class="col-md-9 col-xs-8">
          <dl>
            <dt>neXtProt</dt>
            <dd>Integrated {{integDate}}</dd>
            <dd>Last updated {{lastUpdate}}</dd>
            <dt>UniProtKB</dt>
            <dd>Integrated {{UniprotIntegDate}}</dd>
            <dd>Last updated {{UniprotLastUpdate}}</dd>
            <dd>Entry version {{version}}</dd>
            {{#if lastSeqUpdate}}
            <dd>Last sequence update {{lastSeqUpdate}}</dd>
            {{/if}}
            <dd>Sequence version {{seqVersion}}</dd>
            <dd>{{#accessionNumber}}{{{link_to "history"}}}{{/accessionNumber}}</dd>
          </dl>
        </div>
      </div>
    </div>
    <p class="paragraph">{{data.proteineEvidence}}. {{data.proteineEvidenceCaution}}</p>
  </template>
  <script>
    Polymer({
      is: 'protein-overview',
      properties: {
        nxUrl: {
          type: String
        },
        data: {
          type: Object
        },
        _checkIfLast: function(array,index){
          if(array.length-1===index) return true;
          return false;
        }
      }
    });
  </script>
</dom-module>
